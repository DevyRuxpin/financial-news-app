import{j as e,r,A as k,d as p}from"./index-dcedb060.js";import{N as A}from"./NewsCard-f60a2ff8.js";const S=({filters:s,setFilters:l})=>{const i=[{value:"blockchain",label:"Blockchain"},{value:"earnings",label:"Earnings"},{value:"ipo",label:"IPO"},{value:"mergers_and_acquisitions",label:"M&A"},{value:"financial_markets",label:"Financial Markets"},{value:"economy_fiscal",label:"Fiscal Policy"},{value:"economy_monetary",label:"Monetary Policy"},{value:"technology",label:"Technology"}];return e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Filter News"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tickers (e.g., AAPL,MSFT)"}),e.jsx("input",{type:"text",value:s.tickers,onChange:a=>l({...s,tickers:a.target.value}),className:"w-full p-2 border rounded",placeholder:"AAPL,MSFT"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Topics"}),e.jsxs("select",{value:s.topics,onChange:a=>l({...s,topics:a.target.value}),className:"w-full p-2 border rounded",children:[e.jsx("option",{value:"",children:"All Topics"}),i.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date From"}),e.jsx("input",{type:"date",value:s.time_from,onChange:a=>l({...s,time_from:a.target.value}),className:"w-full p-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sort By"}),e.jsxs("select",{value:s.sort,onChange:a=>l({...s,sort:a.target.value}),className:"w-full p-2 border rounded",children:[e.jsx("option",{value:"LATEST",children:"Latest"}),e.jsx("option",{value:"EARLIEST",children:"Earliest"}),e.jsx("option",{value:"RELEVANCE",children:"Relevance"})]})]})]})]})},F=()=>{const[s,l]=r.useState([]),[i,a]=r.useState(!0),[x,u]=r.useState(null),[c,v]=r.useState(!1),[d,y]=r.useState({tickers:"",topics:"",time_from:"",sort:"LATEST"}),{user:h}=r.useContext(k),m=async(o={},n=!1)=>{var g,b;try{a(!0),u(null),console.log("Fetching news with params:",o);const t=await p.get("/api/news",{params:{...o,useMock:n?"true":"false"},timeout:15e3});if(console.log("News API response:",t.data),!t.data.feed||t.data.feed.length===0){l([]),u("No articles found. Try adjusting your filters.");return}l(t.data.feed),v(n)}catch(t){console.error("Error fetching news:",t.response||t);const N=((b=(g=t.response)==null?void 0:g.data)==null?void 0:b.error)||t.message||"Failed to fetch news articles. Please try again later.";u(N),l([])}finally{a(!1)}},j=()=>{m(d)},f=()=>{m(d,!c)},w=async o=>{if(!h){alert("Please login to save articles");return}try{await p.post("/api/news/save",{user_id:h.id,article_id:o}),alert("Article saved successfully!")}catch(n){console.error("Failed to save article:",n),alert("Failed to save article. Please try again.")}};return r.useEffect(()=>{m(d,!0)},[]),e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Financial News"}),e.jsx("button",{onClick:f,className:`px-4 py-2 rounded transition-colors ${c?"bg-green-600 hover:bg-green-700 text-white":"bg-gray-200 hover:bg-gray-300 text-gray-800"}`,children:c?"Switch to Real Data":"Use Mock Data"})]}),c&&e.jsx("div",{className:"bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded mb-6",children:e.jsx("p",{children:"Note: Using mock data due to API rate limits. Real-time data will be available when the rate limit resets."})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6",children:[e.jsx(S,{filters:d,setFilters:y}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx("button",{onClick:j,className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition-colors",disabled:i,children:i?"Loading...":"Search"})})]}),i?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):x?e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:x}):s.length===0?e.jsx("div",{className:"text-center py-12 text-gray-600 bg-white rounded-xl shadow-sm",children:"No articles found. Try adjusting your filters."}):e.jsx("div",{className:"grid gap-6",children:s.map((o,n)=>e.jsx(A,{article:o,onSave:w},n))})]})};export{F as default};
